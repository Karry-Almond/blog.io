# 区块链

一个写的很好的中文 **比特币** （可能不适用于以太坊）笔记网址，包含了100篇区块链偏向技术和底层知识的博客：http://www.btccfo.com/category/note/

## 默克尔树



具体查看网址：https://blog.csdn.net/weixin_37504041/article/details/80474636

## RLP编码和解码

简单来说，RLP就是一种序列化和反序列化的编码模式。

具体查看网址：https://blog.csdn.net/ggq89/article/details/78629008

## 挖矿

1. ##### 生成Merkle根哈希

   矿工创建区块的第一笔交易，称为Coinbase，这笔交易与其他所有即将打包的交易一起通过Merkle树算法生成Merkle根哈希

   > 打包：在挖矿之前，对于当前这个矿工来说，新区块会包含哪些交易就已经确定好了的。这些被确定被包含的交易就是矿工打包的交易。

2. ##### 组装区块头

   组装区块头就很简单了，矿工会把上一步计算得到的Merkle根哈希，与随机数Nonce、上个区块hash、难度值、时间戳以及版本号组装成一个区块头。这里的随机数是矿工唯一能改变的数值，矿工会不停的改变随机数，计算区块头的hash，直到得到的hash值匹配上全网目标值为止。

3. ##### 计算目标值

   即计算出符合区块链目标的值，比如满足前十个都是0的值



具体查看网址：https://blog.csdn.net/weixin_37504041/article/details/103792215

或https://www.tangshuang.net/4097.html

## 节点类型
### 全节点

- 存储完整的区块链数据。
- 参与区块验证，验证所有区块和状态。
- 所有状态都可以从一个全节点推出。
- 为网络提供服务，并按照请求提供数据。

### 轻节点

- 存储头链并请求其他所有内容。
- 可以对照区块头中的状态根来验证数据的有效性。
- 对于低容量的设备，如嵌入式设备或移动电话来说是有用的，这些设备无法储存数千兆字节的区块链数据。

### 归档节点

- 存储保留在全节点中的所有内容，并建立一个历史状态的归档。 如果您想查询区块 #4,000,000 的帐户余额等内容，或者简单可靠地[使用 OpenEthereum 在不挖坑的情况下测试自己的交易集](https://openethereum.github.io/JSONRPC-trace-module#trace_callmany)，就需要这样做。
- 这些数据的数据量会达到TB级别，这使得存档节点对普通用户的吸引力降低，但对于诸如区块浏览器、钱包供应商和链分析之类的服务而言却很方便。

以存档以外的任何方式同步客户端将导致修剪的区块链数据。 这意味着，没有所有历史状态的档案，但是整个节点都可以按需构建它们。

具体查看网址：https://ethereum.org/zh/developers/docs/nodes-and-clients/#node-types

## 同步策略

### 完全同步 {#full-sync}

完整下载所有区块（包括区块头、交易和接收的数据），并通过执行 每个区块的每个交易 来逐步生成区块链的状态。

- 通过验证每笔交易，最大限度地减少信任并实现最高安全性。
- 随着交易数量的增加，处理所有交易可能需要几天到几周时间。

### 快速同步

快速同步会下载所有区块（包括区块头、交易和接收的数据），验证所有区块头，下载区块状态并对区块头进行验证。

- 依赖共识机制的安全性。
- 同步只需要几个小时。

### 轻量同步

轻量客户端下载所有区块头、区块数据并对其进行随机验证。 仅从信任的检查点同步区块链信息。

- 仅获取最新状态，同时依赖于对开发者的信任和共识机制。
- 客户端已准备好在几分钟内使用当前网络状态

具体查看网址：https://ethereum.org/zh/developers/docs/nodes-and-clients/#sync-modes

## 全节点如何同步区块链